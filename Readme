# ğŸ›¡ï¸ ZeroTrace-X â€“ ML-Driven Network Anomaly Detection

ZeroTrace-X is a **machine learningâ€“based network anomaly detection system** designed for **future integration with Web Application Firewalls (WAFs)**.
It supports both **real-time network monitoring** and **offline log analysis**, providing **explainable alerts**, **severity-based prioritization**, and **administrator-approved security rule recommendations**.

---

## ğŸš€ Key Features

* ğŸ”´ Real-time network traffic analysis
* ğŸ“ Offline log / CSV-based analysis
* ğŸ§  ML-based behavioural anomaly detection
* ğŸ“Š Severity-based alert prioritization
* ğŸ” Explainable alerts with feature-level deviations
* ğŸ” WAF rule recommendations in JSON format
* ğŸ§‘â€ğŸ’» Administrator feedback via false-positive handling
* ğŸ” Continuous baseline learning

---

## âš™ï¸ Setup, Installation & Running (Windows)

### 1ï¸âƒ£ Navigate to the project folder

```powershell
cd ZeroTrace-X
```

---

### 2ï¸âƒ£ Create a Python virtual environment

```powershell
python -m venv venv
```

---

### 3ï¸âƒ£ Activate the virtual environment

```powershell
venv\Scripts\Activate.ps1
```

> If PowerShell blocks script execution:

```powershell
Set-ExecutionPolicy -Scope CurrentUser RemoteSigned
```

---

### 4ï¸âƒ£ Install required dependencies

```powershell
pip install -r .\requirements.txt
```

---

### 5ï¸âƒ£ Start ZeroTrace-X 

```powershell
python .\app.py
```

Or using Flask CLI:

```powershell
flask --app app run --debug
```

### ğŸ“Real-Time Analysis

* Capture live network traffic
* Learn normal behaviour baselines
* Detect anomalies in real time
* Display alerts with explainability in the UI
* Allow investigation, false-positive marking, and WAF rule recommendations

---

### ğŸ“ Offline Analysis

* Open **Offline Analysis** from the application UI
* Upload supported log / CSV files
* Perform batch anomaly detection
* View severity-wise results
* Download:

  * ğŸ“Š Analysis results (CSV)
  * ğŸ” Recommended WAF rules (JSON)

---

## ğŸ§  Explainability

For each detected anomaly, ZeroTrace-X provides:

* Detection decision and severity
* Model outputs and confidence
* **Top feature deviations explaining why the traffic was flagged**
* Recommended security action

This ensures alerts are **transparent, auditable, and easy to understand**.

---

## ğŸ” WAF Rule Recommendation

* Rules are generated in **WAF-agnostic JSON format**
* Rules are **not auto-enforced**
* Designed for **future WAF integration**
* Administrator review and approval is required before deployment

---

## ğŸ” Continuous Learning

* Alerts marked as **False Positive**:

  * Are removed from active alerts
  * Are incorporated into baseline learning
* Helps reduce false positives and improve detection accuracy over time

---

## ï¿½ Project Structure

```
ZeroTrace-X/
â”œâ”€â”€ ğŸ“„ app.py                           (Main Flask application)
â”œâ”€â”€ ğŸ“„ predict.py                       (ML prediction engine)
â”œâ”€â”€ ğŸ“„ flow_tracker.py                  (Network flow tracking)
â”œâ”€â”€ ğŸ“„ requirements.txt                 (Python dependencies)
â”œâ”€â”€ ğŸ“„ Readme                           (This file)
â”‚
â”œâ”€â”€ ğŸ“ data/                            (Persistent data storage)
â”‚   â”œâ”€â”€ alerts_store.json               (Alert records)
â”‚   â””â”€â”€ logs_store.json                 (Log records)
â”‚
â”œâ”€â”€ ğŸ“ ml/models/                       (ML model artifacts)
â”‚   â”œâ”€â”€ ğŸ“ home/                        (Home network model)
â”‚   â”‚   â”œâ”€â”€ home_iforest.pkl            (Isolation Forest model)
â”‚   â”‚   â”œâ”€â”€ home_scaler.pkl             (StandardScaler for preprocessing)
â”‚   â”‚   â”œâ”€â”€ home_threshold.json         (Anomaly threshold)
â”‚   â”‚   â”œâ”€â”€ home_feature_order.txt      (Feature names)
â”‚   â”‚   â””â”€â”€ (other model files)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ industrial/                  (Industrial network model)
â”‚   â”‚   â”œâ”€â”€ isolation_forest.pkl        (Isolation Forest model)
â”‚   â”‚   â”œâ”€â”€ scaler.pkl                  (StandardScaler for preprocessing)
â”‚   â”‚   â”œâ”€â”€ threshold.json              (Anomaly threshold)
â”‚   â”‚   â”œâ”€â”€ feature_order.txt           (27 features)
â”‚   â”‚   â””â”€â”€ (other model files)
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ live/                        (Runtime-trained adaptive baseline)
â”‚       â”œâ”€â”€ live_iforest.pkl            (Trained model)
â”‚       â”œâ”€â”€ live_scaler.pkl             (Preprocessor)
â”‚       â”œâ”€â”€ live_metadata.json          (Training stats)
â”‚       â””â”€â”€ live_baseline_buffer.csv    (Training buffer)
â”‚
â”œâ”€â”€ ğŸ“ training/                        (Model training scripts)
â”‚   â”œâ”€â”€ ğŸ“ home_network/                (Home network training pipeline)
â”‚   â”‚   â”œâ”€â”€ step1.py                    (Data cleaning)
â”‚   â”‚   â”œâ”€â”€ step2.py                    (Feature scaling)
â”‚   â”‚   â”œâ”€â”€ step3.py                    (Model training)
â”‚   â”‚   â””â”€â”€ step4.py                    (Threshold calculation)
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ industrial_network/          (Industrial network training pipeline)
â”‚       â”œâ”€â”€ Step_1_Extract.py           (Data extraction)
â”‚       â”œâ”€â”€ Step_2_preprocess.py        (Preprocessing)
â”‚       â”œâ”€â”€ Step_3_train_iforest.py     (Model training)
â”‚       â””â”€â”€ Step_4_threshold.py         (Threshold calculation)
â”‚
â”œâ”€â”€ ğŸ“ templates/                       (Web UI templates)
â”‚   â”œâ”€â”€ index.html                      (Landing page)
â”‚   â”œâ”€â”€ online.html                     (Live monitoring dashboard)
â”‚   â””â”€â”€ offline.html                    (CSV analysis interface)
â”‚
â””â”€â”€ ğŸ“ venv/                            (Python virtual environment)
```

---

## ğŸ§  Model Architecture

ZeroTrace-X uses **three Isolation Forest models** for comprehensive anomaly detection:

| Model | Purpose | Training Data | Features |
|-------|---------|---------------|----------|
| **Home** | Detect anomalies in home/small network traffic | home_flow_features.csv | 21 features |
| **Industrial** | Detect anomalies in industrial network (CSECICIDS2018) | CSECICIDS2018 dataset | 27 features |
| **Live Baseline** | Adaptive real-time baseline learning | Runtime collected flows | Dynamic feature set |

**Severity Decision Logic:**
- **CRITICAL**: All 3 models detect anomaly OR anomaly score < threshold Ã— 2.0
- **HIGH**: 2+ models detect anomaly
- **MEDIUM**: 1 model detects anomaly  
- **LOW**: Potential concern (borderline scores)

---

## ğŸ“ Notes

* Analysis time may vary depending on traffic volume or log size
* Designed for demonstration and future extensibility
* No direct production WAF enforcement in demo mode
* Models are trained with Isolation Forest (contamination=0.01)
* Live baseline automatically retrains every 500 new flows
* Data persisted in JSON format for easy inspection and debugging

---

## ğŸ Conclusion

ZeroTrace-X demonstrates how **machine learning can enhance network security** by combining **real-time anomaly detection**, **clear explainability**, and **safe, administrator-controlled rule recommendations** for future WAF integration.

---

